<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Rental Intelligence Dashboard</title>

    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: #f4f6f8;
        }


        .navbar {
            background: #1e293b;
            color: white;
            display: flex;
            padding: 15px 30px;
            justify-content: space-between;
            align-items: center;
        }

        .navbar h2 {
            margin: 0;
        }

        .navbar ul {
            list-style: none;
            display: flex;
            gap: 20px;
            margin: 0;
        }

        .navbar li {
            cursor: pointer;
        }

        .navbar li:hover {
            text-decoration: underline;
        }

        /* ---------- CONTENT ---------- */
        .container {
            max-width: 900px;
            margin: auto;
            padding: 20px;
        }

        .card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }

        /* ---------- FORM ---------- */
        label {
            font-weight: bold;
            margin-top: 10px;
            display: block;
        }

        input,
        select,
        button {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
        }

        button {
            background: #2563eb;
            color: white;
            border: none;
            margin-top: 20px;
            cursor: pointer;
        }

        button:hover {
            background: #1e40af;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .kpi {
            background: #e5e7eb;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .hidden {
            display: none;
        }

        .result {
            margin-top: 15px;
            font-size: 18px;
        }

        .error {
            color: red;
        }

        .card iframe {
            border-radius: 12px;
            margin-top: 10px;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);
        }

        .powerbi-container {
            width: 100%;
            height: 500px;
            margin-top: 15px;
        }

        .powerbi-container iframe {
            width: 100%;
            height: 100%;
            border-radius: 10px;
        }

        .note {
            margin-top: 12px;
            font-size: 14px;
            color: #666;
        }
    </style>
</head>

<body>

    <div class="navbar">
        <h2>Rental AI (Get you appartment rent Price )</h2>
        <ul>
            <li onclick="showPage('predict')">Predict Price</li>
            <li onclick="showPage('overall')">Overall Dashboard</li>
            <li onclick="showPage('live')">Live Dashboard</li>
        </ul>
    </div>

    <div class="container">


        <div id="predict" class="card">
            <h3>Predict Rental Price</h3>
            <label>Amenities</label>
            <select id="amenities">
                <option value="">Select Amenities</option>

                <option value="Other">Other</option>

                <option value="Parking">Parking</option>
                <option value="Gym">Gym</option>
                <option value="Pool">Pool</option>
                <option value="Storage">Storage</option>

                <option value="Gym,Pool">Gym + Pool</option>
                <option value="Parking,Pool">Parking + Pool</option>
                <option value="Parking,Storage">Parking + Storage</option>

                <option value="Gym,Parking,Pool">Gym + Parking + Pool</option>
                <option value="Gym,Parking,Pool,Storage">Gym + Parking + Pool + Storage</option>

                <option value="Washer Dryer">Washer / Dryer</option>
                <option value="Parking,Washer Dryer">Parking + Washer / Dryer</option>

                <option value="Patio/Deck">Patio / Deck</option>
                <option value="Parking,Patio/Deck">Parking + Patio / Deck</option>
                <option value="Parking,Patio/Deck,Storage">Parking + Patio / Deck + Storage</option>

                <option value="Wood Floors">Wood Floors</option>
                <option value="Parking,Wood Floors">Parking + Wood Floors</option>

                <option value="Dishwasher,Refrigerator">Dishwasher + Refrigerator</option>
                <option value="Refrigerator">Refrigerator</option>

                <option value="Clubhouse,Gym,Pool">Clubhouse + Gym + Pool</option>
                <option value="Clubhouse,Gym,Parking,Pool">Clubhouse + Gym + Parking + Pool</option>

                <option value="Cable or Satellite,TV">Cable / Satellite TV</option>
            </select>


            <label>Pets Allowed</label>
            <select id="pets_allowed">
                <option value="">Select</option>
                <option value="yes">Yes</option>
                <option value="no">No</option>
                <option value="yes">Cats</option>
                <option value="yes">Dogs</option>
            </select>
            <label>State</label>
            <select id="state">
                <option value="">Select State</option>

                <option value="Other">Other</option>

                <option value="TX">Texas (TX)</option>
                <option value="CA">California (CA)</option>
                <option value="VA">Virginia (VA)</option>
                <option value="NC">North Carolina (NC)</option>
                <option value="CO">Colorado (CO)</option>
                <option value="FL">Florida (FL)</option>
                <option value="MD">Maryland (MD)</option>
                <option value="OH">Ohio (OH)</option>
                <option value="MA">Massachusetts (MA)</option>
                <option value="GA">Georgia (GA)</option>
                <option value="NJ">New Jersey (NJ)</option>
                <option value="WA">Washington (WA)</option>
                <option value="NV">Nevada (NV)</option>
                <option value="AZ">Arizona (AZ)</option>
                <option value="MO">Missouri (MO)</option>
                <option value="LA">Louisiana (LA)</option>
                <option value="IL">Illinois (IL)</option>
                <option value="PA">Pennsylvania (PA)</option>
                <option value="TN">Tennessee (TN)</option>
                <option value="NE">Nebraska (NE)</option>
            </select>


            <label>City</label>
            <select id="cityname">
                <option value="">Select City</option>
            </select>





            <label>Bathrooms</label>
            <input id="bathrooms" type="number" step="0.5" value="2">

            <label>Bedrooms</label>
            <input id="bedrooms" type="number" value="2">

            <label>Square Feet</label>
            <input id="square_feet" type="number" value="900">

            <label>Fee</label>
            <select id="fee">
                <option value="0">No</option>
                <option value="1">Yes</option>
            </select>

            <label>Has Photo</label>
            <select id="has_photo">
                <option value="1">Yes</option>
                <option value="0">No</option>
            </select>

            <label>Latitude</label>
            <input id="latitude" type="number" step="0.0001" value="32.7767">

            <label>Longitude</label>
            <input id="longitude" type="number" step="0.0001" value="-96.7970">

            <button onclick="predict()">Predict</button>

            <div class="result" id="result"></div>
        </div>
        <div id="overall" class="card hidden">
            <h3>over all Dashboard</h3>
            <p>Real-time rental insights powered by Power BI</p>

            <iframe title="Rental Price Dashboard"
                src="https://app.powerbi.com/view?r=eyJrIjoiNjI1NDU5YjEtMWUzYy00MjA1LTljMGEtODg3ZmFmMjkyZTI2IiwidCI6ImVlZjg2NjUxLTBjODItNGIzMS05NDcyLTdmMGI2MmZiZTk1MSIsImMiOjl9"
                width="100%" height="550" frameborder="0" allowfullscreen="true">
            </iframe>
        </div>



    </div>

    <div id="live" class="card hidden">
        <h3>Live Analytics Dashboard</h3>
        <p>Real-time rental insights powered by Power BI</p>

        <iframe title="Rental Price Dashboard"
            src="https://app.powerbi.com/view?r=eyJrIjoiZWNhNmI2OTEtOGFmNi00MDQzLWI1MDgtNzMwNjAzNGRhMDY0IiwidCI6ImVlZjg2NjUxLTBjODItNGIzMS05NDcyLTdmMGI2MmZiZTk1MSIsImMiOjl9"
            width="100%" height="550" frameborder="0" allowfullscreen="true">
        </iframe>
    </div>


    </div>

    <script>
        function showPage(page) {
            document.getElementById("predict").classList.add("hidden");
            document.getElementById("overall").classList.add("hidden");
            document.getElementById("live").classList.add("hidden");
            document.getElementById(page).classList.remove("hidden");
        }

        async function predict() {
            const payload = {
                amenities: document.getElementById("amenities").value || null,
                pets_allowed: document.getElementById("pets_allowed").value || null,
                cityname: document.getElementById("cityname").value || null,
                state: document.getElementById("state").value || null,
                bathrooms: Number(document.getElementById("bathrooms").value),
                bedrooms: Number(document.getElementById("bedrooms").value),
                fee: Number(document.getElementById("fee").value),
                has_photo: Number(document.getElementById("has_photo").value),
                square_feet: Number(document.getElementById("square_feet").value),
                latitude: Number(document.getElementById("latitude").value),
                longitude: Number(document.getElementById("longitude").value)
            };

            const result = document.getElementById("result");
            result.innerHTML = "Predicting...";

            try {
                const res = await fetch("http://127.0.0.1:8000/predict", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(payload)
                });

                const data = await res.json();
                if (!res.ok) throw new Error(data.detail);

                result.innerHTML = `<strong>Estimated Rent:</strong> $${data.predicted_price.toFixed(0)}`;
            } catch (e) {
                result.innerHTML = `<span class="error">${e.message}</span>`;
            }
        }


        setInterval(() => {
            document.getElementById("liveValue").innerText =
                "$" + Math.floor(1500 + Math.random() * 700);
        }, 2000);
    </script>
    <script>
        const stateCities = {
            "TX": ["Dallas", "Austin", "San Antonio", "Houston"],
            "CA": ["Los Angeles", "San Diego"],
            "CO": ["Denver", "Colorado Springs"],
            "VA": ["Arlington", "Alexandria", "Richmond"],
            "NC": ["Charlotte", "Raleigh", "Greensboro"],
            "OH": ["Cincinnati", "Cleveland", "Columbus"],
            "MA": ["Boston"],
            "GA": ["Atlanta"],
            "NJ": ["Jersey City"],
            "NV": ["Las Vegas"],
            "AZ": ["Tucson"],
            "NE": ["Omaha"],
            "Other": ["Other"]
        };

        // if you want "Other" state to show ALL cities too:
        const allCities = [
            "Other", "Dallas", "Denver", "Los Angeles", "Las Vegas", "Arlington", "Atlanta", "Charlotte",
            "Austin", "San Antonio", "Raleigh", "Richmond", "Alexandria", "Houston", "Cincinnati",
            "San Diego", "Tampa", "Colorado Springs", "Chicago", "Columbus", "Kansas City", "Omaha",
            "Cleveland", "Norfolk", "Boston", "Tucson", "Marietta", "Jersey City", "Greensboro"
        ];

        function populateCities(state) {
            const citySelect = document.getElementById("cityname");

            // clear existing options
            citySelect.innerHTML = `<option value="">Select City</option>`;

            let cities = stateCities[state] || [];

            // If you want OTHER to show all cities:
            if (state === "Other" || state === "") {
                cities = allCities;
            }

            cities.forEach(city => {
                const opt = document.createElement("option");
                opt.value = city;
                opt.textContent = city;
                citySelect.appendChild(opt);
            });
        }

        document.getElementById("state").addEventListener("change", function () {
            populateCities(this.value);
        });

        populateCities(document.getElementById("state").value || "");
    </script>

</body>

</html>